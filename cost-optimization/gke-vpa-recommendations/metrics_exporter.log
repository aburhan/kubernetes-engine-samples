2024-12-18 02:54:09,614 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 02:54:09,614 [INFO] [main] Found 10 namespaces to process
2024-12-18 02:54:09,615 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:10,615 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:10,615 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:11,616 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:11,617 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:12,617 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:12,617 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:13,618 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:13,619 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:14,619 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:14,620 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:15,620 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:15,621 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:16,621 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:16,621 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:17,622 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:17,622 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:18,623 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:18,623 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 02:54:19,624 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.68 MB
2024-12-18 02:54:19,625 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:19,650 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,651 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:19,663 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,664 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:19,677 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,677 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:19,689 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,690 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:19,702 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,703 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:19,714 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,715 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:19,727 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,727 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:19,740 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,740 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:19,753 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,754 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:19,768 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,768 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:19,782 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,782 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:19,794 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,795 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:19,807 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,808 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:19,820 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,821 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:19,833 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,834 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:19,846 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,846 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:19,858 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,859 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:19,870 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,871 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:19,883 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,883 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:19,896 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,896 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:19,908 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,908 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:19,920 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,920 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:19,933 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,934 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:19,945 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,946 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:19,957 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,958 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:19,972 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,972 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:19,987 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,987 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:19,998 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:19,999 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,010 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,010 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,021 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,021 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,032 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,033 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,043 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,044 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,055 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,055 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,066 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,067 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,079 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,079 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,090 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,091 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,102 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,102 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,113 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,114 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,125 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,125 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,137 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,137 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,149 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,149 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,162 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,162 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,175 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,175 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,187 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,188 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,199 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,199 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,211 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,212 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,223 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,223 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,234 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,235 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,246 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,246 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,257 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,258 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,270 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,271 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,284 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,284 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,297 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,297 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,309 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,310 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,322 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,322 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,334 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,334 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,346 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,347 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,359 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,359 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,371 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,372 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,384 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,384 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,395 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,396 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,407 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,408 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,420 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,421 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,433 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,433 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,444 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,445 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,457 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,457 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,470 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,470 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,482 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,482 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,494 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,494 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,505 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,506 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,517 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,518 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,530 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,530 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 02:54:20,541 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,542 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 02:54:20,552 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,553 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 02:54:20,566 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,566 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 02:54:20,578 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,578 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 02:54:20,589 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,590 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 02:54:20,601 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,601 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 02:54:20,669 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:20,669 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 02:54:20,681 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 02:54:21,375 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,391 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,392 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,396 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,407 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,407 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,417 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,417 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,427 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,428 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,437 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,438 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,448 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,448 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,457 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,458 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,471 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,471 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,481 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,482 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,493 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,493 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,503 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,504 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,515 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,515 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,526 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,526 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,536 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,537 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,546 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,547 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,556 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,557 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,566 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,567 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,576 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,577 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,587 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,588 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,599 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,599 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,609 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,609 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,619 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,620 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,631 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,631 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,641 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,642 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,651 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,652 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,662 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,662 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,672 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,672 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,683 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,683 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,694 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,694 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,705 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,705 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,715 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,717 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,717 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,717 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,718 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,718 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,718 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,719 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,719 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,719 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,720 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,720 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,720 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,720 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,721 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,721 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,722 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,722 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,722 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,723 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,723 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,724 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,724 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,724 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,725 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,725 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,726 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 02:54:21,726 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,726 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,727 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,727 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,728 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,737 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,742 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 02:54:21,743 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,755 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,755 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,766 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,766 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,777 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,777 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,787 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,788 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,798 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,798 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,808 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,809 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,819 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,820 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,830 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,830 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,841 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,841 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,850 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,851 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,861 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,861 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,871 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,872 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,881 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,882 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,891 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:21,892 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,902 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,903 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,913 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,914 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,924 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,925 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,935 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:21,936 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,946 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,947 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,958 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,959 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,969 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:21,970 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,981 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:21,982 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:21,992 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:21,993 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,005 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,005 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,015 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,016 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,027 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,028 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,037 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,038 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,039 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,039 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,039 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,040 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,040 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,041 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,041 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,041 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,042 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,042 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,042 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:22,043 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,043 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,044 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,044 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:22,045 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,045 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:22,046 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,046 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,046 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,047 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,047 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,048 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,048 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,048 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,049 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 02:54:22,049 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,059 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,062 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,063 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,074 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,074 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,085 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,086 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,096 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,097 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,107 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,108 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,118 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,118 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,129 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,129 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,140 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,141 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,151 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:22,152 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,162 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,163 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,173 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,176 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,177 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,177 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,177 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 02:54:22,178 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,178 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,179 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 02:54:22,179 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 02:54:22,179 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,180 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 02:54:22,180 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,190 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,190 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,200 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,202 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,202 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,203 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,212 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,213 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:22,224 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,226 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,227 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:22,305 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:22,347 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:22,376 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:23,092 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:23,450 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:23,451 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:23,452 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,452 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:23,452 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,452 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:23,452 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,453 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:23,454 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,455 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:23,455 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,455 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:23,455 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:23,778 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FiODc3OC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEx"

2024-12-18 02:54:23,782 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:23,783 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:23,783 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:23,784 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:24,785 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 173.82 MB
2024-12-18 02:54:24,785 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:24,861 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:24,902 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:24,913 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:24,920 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:25,037 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:25,038 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:25,039 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,039 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:25,039 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,039 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:25,040 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,040 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:25,040 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,040 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:25,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:25,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:25,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:25,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:25,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:25,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,043 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:25,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,043 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:25,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:25,205 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FiODg0My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA"

2024-12-18 02:54:25,206 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:25,206 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:25,207 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:25,207 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:26,208 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 174.76 MB
2024-12-18 02:54:26,208 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:26,285 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:26,325 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:26,336 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:26,343 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:26,443 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:26,444 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:26,445 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,445 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:26,445 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,445 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:26,446 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,446 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:26,446 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,446 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:26,447 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,447 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:26,447 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,447 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:26,447 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,448 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:26,448 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,448 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:26,448 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,448 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:26,449 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,449 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:26,449 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,449 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:26,450 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:26,612 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FiODkwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy"

2024-12-18 02:54:26,613 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:26,613 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:26,613 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:26,614 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:27,615 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 174.92 MB
2024-12-18 02:54:27,615 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:27,695 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:27,737 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:27,748 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:27,755 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:27,838 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:27,839 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:27,840 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,840 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:27,840 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,840 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:27,841 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,841 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:27,841 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,841 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:27,842 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:27,842 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:27,843 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,843 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:27,843 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,843 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:27,844 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,844 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:27,844 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,844 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:27,844 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:27,845 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:27,845 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:28,007 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FiODljOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0"

2024-12-18 02:54:28,008 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:28,008 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:28,008 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:28,009 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:29,010 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.06 MB
2024-12-18 02:54:29,010 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:29,012 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,022 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,023 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,034 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,035 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,044 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,045 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,055 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,055 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,065 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,066 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 02:54:29,077 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,077 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,078 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,078 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,078 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,079 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,079 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 02:54:29,156 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:29,196 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:29,208 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:29,215 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:29,365 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:29,366 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:29,366 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:29,367 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:29,370 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,370 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:29,370 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:29,531 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FiOGE4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc"

2024-12-18 02:54:29,532 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:29,532 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:29,533 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:29,534 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:30,534 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 175.20 MB
2024-12-18 02:54:30,535 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:30,611 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:30,652 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:30,663 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:30,670 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:30,756 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:30,757 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:30,757 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,757 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:30,757 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,758 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:30,758 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,758 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:30,758 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,759 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:30,759 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,759 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:30,759 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,759 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:30,760 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,760 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:30,760 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,760 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:30,761 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,761 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:30,761 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,761 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:30,761 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,762 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:30,762 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:30,923 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FiOGI0Yy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM"

2024-12-18 02:54:30,924 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:30,925 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:30,925 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:30,925 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:31,926 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 175.32 MB
2024-12-18 02:54:31,927 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:32,003 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:32,043 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:32,055 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:32,062 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:32,145 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:32,146 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:32,146 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,146 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:32,146 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,146 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:32,147 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,148 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:32,149 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,149 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:32,149 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,149 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:32,149 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:32,311 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FiOGJmYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI"

2024-12-18 02:54:32,312 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:32,312 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:32,313 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:32,313 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:33,314 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.42 MB
2024-12-18 02:54:33,314 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:33,390 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:33,430 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:33,441 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:33,448 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:33,528 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:33,529 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:33,529 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:33,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:33,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:33,694 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FiOGNhZi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEx"

2024-12-18 02:54:33,695 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:33,695 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:33,695 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:33,696 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:34,697 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.43 MB
2024-12-18 02:54:34,697 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:34,772 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:34,811 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:34,821 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:34,829 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:34,916 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:34,917 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:34,917 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,918 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:34,918 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,918 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:34,918 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,919 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:34,919 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,919 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:34,919 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,920 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:34,920 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,920 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:34,920 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,920 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:34,921 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,921 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:34,921 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,921 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:34,922 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,922 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:34,922 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:34,922 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:34,923 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:35,084 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FiOGQ2Ni0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0"

2024-12-18 02:54:35,085 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:35,086 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:35,086 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:35,087 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:36,088 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.55 MB
2024-12-18 02:54:36,088 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:36,163 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 02:54:36,204 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 02:54:36,215 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 02:54:36,222 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 02:54:36,305 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 02:54:36,306 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 02:54:36,307 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,307 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 02:54:36,308 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,308 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 02:54:36,308 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,308 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 02:54:36,309 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,309 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 02:54:36,309 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,309 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 02:54:36,309 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,310 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 02:54:36,310 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,310 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 02:54:36,310 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,311 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 02:54:36,311 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,311 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 02:54:36,311 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,312 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 02:54:36,312 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,312 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 02:54:36,312 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 02:54:36,634 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FiOGUxYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA"

2024-12-18 02:54:36,635 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 02:54:36,635 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 02:54:36,636 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 02:54:36,636 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 02:54:37,637 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.54 MB
2024-12-18 02:54:37,637 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 02:54:37,638 [INFO] [main] Processing completed: 10 successful, 0 failed.
2024-12-18 02:54:38,639 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 175.54 MB
2024-12-18 02:54:38,641 [INFO] [<module>] Finished processing in 29.03 seconds
2024-12-18 03:12:01,238 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:12:01,238 [INFO] [main] Found 10 namespaces to process
2024-12-18 03:12:01,238 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:02,239 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:02,239 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:03,240 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:03,240 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:04,241 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 136.26 MB
2024-12-18 03:12:04,241 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:05,242 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:05,242 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:06,243 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:06,243 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:07,244 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:07,244 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:08,245 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:08,245 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:09,246 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:09,246 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:10,247 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:10,247 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:12:11,248 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.26 MB
2024-12-18 03:12:11,249 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,272 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,274 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,285 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,286 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,297 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,297 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,307 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,308 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,318 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,318 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,329 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,329 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,340 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,340 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,350 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,351 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,361 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,361 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,372 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,373 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,384 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,385 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,396 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,396 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,407 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,408 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,419 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,420 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,431 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,431 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,443 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,443 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,453 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,454 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,464 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,465 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,477 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,478 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,488 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,489 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,500 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,501 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,513 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,514 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,525 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,525 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,536 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,537 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,547 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,548 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,559 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,559 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,573 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,574 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,586 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,586 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,597 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,597 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,608 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,608 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,619 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,620 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,631 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,631 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,642 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,643 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,653 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,654 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,665 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,666 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,677 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,678 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,688 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,689 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,700 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,700 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,711 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,712 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,722 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,723 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,734 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,734 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,745 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,745 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,756 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,756 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,767 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,767 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,778 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,778 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,790 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,790 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,802 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,802 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,813 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,814 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,824 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,825 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,836 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,836 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,847 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,847 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,857 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,858 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,868 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,869 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,879 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,880 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,890 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,891 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,901 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,901 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:11,912 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,912 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:11,923 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,923 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:11,934 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,934 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:11,945 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,945 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:11,956 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,957 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:11,968 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,968 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:11,979 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,979 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:11,989 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:11,990 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:12,000 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,001 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:12,011 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,011 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:12,021 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,022 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:12,031 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,032 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:12,042 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,043 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:12,054 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,055 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:12,066 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,066 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:12,078 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,078 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:12:12,089 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,089 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:12:12,100 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,101 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:12:12,114 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,114 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:12:12,126 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,127 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:12:12,137 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,138 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:12:12,149 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,150 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:12:12,217 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,218 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:12:12,229 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:12:12,933 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:12,948 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:12,949 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:12,950 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:12,960 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:12,960 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:12,971 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:12,971 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:12,981 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:12,981 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:12,982 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:12,982 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:12,984 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:12,994 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:12,994 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,004 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,005 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,015 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,016 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,016 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,017 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,017 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,028 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,029 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,030 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,041 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,042 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,051 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,053 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,054 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,054 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,065 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,065 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,078 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,078 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,089 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,090 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,100 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,100 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,111 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,111 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,122 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,123 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,123 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,124 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,124 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,125 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,125 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,125 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,135 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,138 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,139 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,148 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,149 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,159 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,160 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,169 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,170 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,180 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,181 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,190 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,191 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,200 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,201 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,211 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,212 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,222 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,222 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,232 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,232 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,242 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,243 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,244 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,244 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:12:13,244 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,245 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,245 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,246 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:12:13,246 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,246 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,247 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,247 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,257 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,258 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,259 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,270 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,271 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,282 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,283 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,292 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,294 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,294 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,295 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,295 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,306 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,307 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,308 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,317 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,318 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,328 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,328 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,338 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,340 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,340 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,340 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,341 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,350 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,351 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,361 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,363 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,363 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,364 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,373 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,374 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,385 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,385 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,396 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,397 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,408 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,409 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,410 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,410 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,411 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,411 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,423 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,425 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,425 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,437 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,437 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,447 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,448 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,458 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,459 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,468 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,469 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,479 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,480 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,481 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:13,481 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,481 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,482 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:13,482 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,491 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,492 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,501 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,502 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,512 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,513 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,513 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,514 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:13,516 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,526 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,526 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,536 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,537 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,546 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,547 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,558 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,558 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,568 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,569 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,579 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,580 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,580 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:13,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,582 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,582 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:13,766 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,776 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:13,777 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:13,778 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:13,788 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:13,863 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:13,905 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:13,918 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:13,936 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:14,195 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYmVmNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:12:14,196 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:14,197 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:14,197 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,197 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,198 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:14,199 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:14,200 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,203 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:14,238 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:14,296 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:14,298 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,302 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,314 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,315 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,324 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:14,325 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,334 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:14,334 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,343 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,344 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,353 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,353 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,363 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,363 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,373 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,373 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,382 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,382 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,392 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,392 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,401 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,402 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,412 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,412 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,422 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,422 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,432 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:14,433 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,443 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,443 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,453 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,453 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,463 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,463 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,474 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,474 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,484 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,484 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,494 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,494 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,504 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,504 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,518 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,518 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:12:14,527 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,528 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,529 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:12:14,529 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:14,529 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,530 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,530 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,530 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,531 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,531 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,531 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,532 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:12:14,532 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:12:14,532 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:12:14,533 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:12:14,533 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,534 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,534 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,535 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,535 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,535 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,536 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,536 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:12:14,617 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:14,657 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:14,669 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:14,676 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:14,778 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYmY1OS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:12:14,778 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:14,779 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:14,779 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,780 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:14,780 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,780 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:14,780 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,780 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:14,781 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,781 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:14,781 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,781 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:14,781 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,782 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:14,782 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,782 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:14,782 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,783 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:14,783 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,783 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:14,783 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,783 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:14,784 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,784 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:14,784 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:14,786 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:14,787 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:14,788 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:14,870 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:14,911 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:14,923 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:14,931 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:15,015 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYmZhMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:12:15,016 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:15,016 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:15,017 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,017 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:15,017 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,017 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:15,018 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,018 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:15,018 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,018 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,019 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:15,020 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,020 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:15,020 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,020 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:15,020 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,021 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:15,021 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,021 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:15,021 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,024 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:15,025 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:15,026 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:15,111 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:15,157 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:15,170 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:15,177 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:15,285 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYmZkMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:12:15,285 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:15,286 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:15,286 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,287 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:15,287 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,287 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:15,287 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,288 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:15,288 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,288 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:15,288 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,289 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:15,289 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,289 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:15,289 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,289 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:15,290 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,290 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:15,290 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,291 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:15,291 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,291 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:15,292 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,292 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:15,292 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,294 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:15,295 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:15,296 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:15,379 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:15,426 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:15,438 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:15,446 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:15,526 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYmZmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:12:15,527 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:15,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:15,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,528 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:15,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,528 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:15,529 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,529 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:15,529 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,529 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:15,529 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:15,530 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:15,530 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,530 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:15,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,531 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:15,531 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,531 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:15,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:15,532 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,532 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:15,533 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,535 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:15,536 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:15,537 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:15,622 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:15,665 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:15,676 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:15,683 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:15,762 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FkYzAyMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:12:15,763 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:15,764 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:15,764 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,764 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:15,765 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,765 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:15,765 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,765 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:15,765 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,766 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:15,766 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,766 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:15,766 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,766 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:15,767 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,767 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:15,767 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,767 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:15,767 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,768 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:15,768 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,768 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:15,768 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,769 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:15,769 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,771 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:15,773 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:15,774 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:15,852 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:15,894 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:15,905 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:15,912 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:15,992 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzA0MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:12:15,992 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:15,993 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:15,993 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,994 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:15,994 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,994 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:15,994 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,994 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:15,995 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,995 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:15,995 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,995 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:15,996 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,996 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:15,996 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,996 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:15,997 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,997 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:15,997 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,997 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:15,998 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,998 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:15,998 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:15,998 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:15,998 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,000 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:16,002 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:16,003 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:16,090 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:16,133 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:16,150 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:16,159 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:16,236 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzA2NS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
2024-12-18 03:12:16,237 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:16,238 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:16,238 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,238 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:16,238 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,238 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:16,239 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,239 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:16,239 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,239 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:16,239 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,240 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:16,240 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,240 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:16,240 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,241 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:16,241 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,241 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:16,241 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,241 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:16,242 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,242 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:16,242 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,242 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:16,243 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,245 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:16,246 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:16,247 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:16,325 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:16,366 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:16,376 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:16,383 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:16,463 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzA4Yy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:12:16,464 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:16,464 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:16,465 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,465 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:16,465 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,465 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:16,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,466 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:16,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,466 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:16,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:16,467 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:16,467 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:16,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,468 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:16,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,468 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:16,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,469 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:16,469 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,469 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:16,469 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,471 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:16,472 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:16,473 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:16,551 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:12:16,592 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:12:16,605 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:12:16,612 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:16,689 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzBhNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:12:16,689 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:16,690 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:16,691 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,691 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:16,691 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,691 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:16,692 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,692 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:16,692 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,692 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:16,693 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,693 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:16,693 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,693 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:16,694 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,694 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:16,694 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,694 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:16,695 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,695 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:16,695 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,695 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:16,696 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,696 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:16,696 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:16,698 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:16,699 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:16,700 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: None Exception iterating requests!
2024-12-18 03:12:19,310 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:19,399 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzIwOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:12:19,399 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:19,400 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:19,401 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,401 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:19,401 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,402 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:19,402 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,402 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:19,402 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,402 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:19,403 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,403 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:19,403 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,403 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:19,404 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,404 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:19,404 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,404 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:19,405 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,405 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:19,405 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,405 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:19,406 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,406 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:19,406 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,408 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:19,409 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:19,410 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:19,796 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:19,875 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzI0OC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:12:19,876 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:19,877 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:19,877 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,877 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:19,877 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:19,878 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:19,878 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:19,879 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,879 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:19,879 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,879 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:19,880 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,880 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:19,880 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,880 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:19,880 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,881 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:19,881 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,881 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:19,882 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,882 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:19,882 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:19,884 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:19,885 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:19,886 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:20,033 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:20,114 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzI2Yi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:12:20,114 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:20,115 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:20,115 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,115 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:20,115 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,116 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:20,116 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,116 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:20,116 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,116 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:20,117 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,117 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:20,117 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,117 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:20,118 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,118 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:20,118 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,118 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:20,118 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:20,119 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,121 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:20,123 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:20,123 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:20,303 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:20,384 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzI4NC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:12:20,385 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:20,386 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:20,386 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,386 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:20,386 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,387 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:20,387 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,387 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:20,387 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:20,388 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,389 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:20,389 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,389 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:20,389 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,389 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:20,390 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,390 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:20,390 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,390 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:20,391 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,393 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:20,394 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:20,394 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:20,546 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:20,619 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYzJhNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
2024-12-18 03:12:20,619 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:20,620 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:20,620 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,621 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:20,621 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,621 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:20,621 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,621 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:20,622 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,622 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:20,622 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,622 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:20,623 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,623 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:20,623 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,623 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:20,623 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,624 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:20,624 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,624 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:20,624 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,624 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:20,625 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,625 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:20,625 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,627 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:20,629 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:20,630 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:20,782 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:20,859 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzJkMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:12:20,859 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:20,860 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:20,861 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,861 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:20,861 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,861 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:20,861 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,862 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:20,862 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,862 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:20,862 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,862 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:20,863 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,863 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:20,863 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,863 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:20,864 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,864 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:20,864 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,864 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:20,864 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,865 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:20,865 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,865 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:20,866 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:20,868 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:20,869 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:20,870 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:21,010 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:21,092 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYzJmYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:12:21,092 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:21,093 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:21,093 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:21,094 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,095 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:21,096 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,097 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:21,097 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,099 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:21,100 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:21,101 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:21,254 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:21,338 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYzMxZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:12:21,339 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:21,340 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:21,340 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,340 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:21,340 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,340 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:21,341 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,341 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:21,341 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,341 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:21,342 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,342 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:21,342 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,342 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:21,343 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,343 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:21,343 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,343 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:21,344 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,344 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:21,344 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,344 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:21,345 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,345 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:21,345 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,347 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:21,348 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:21,349 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:21,480 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:21,555 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FkYzMzNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:12:21,555 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:21,556 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:21,556 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,556 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:21,556 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,557 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,558 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:21,559 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,562 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:21,562 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:21,563 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:21,708 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:21,795 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzM1MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:12:21,795 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:21,796 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:21,797 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,797 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:21,797 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,797 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:21,797 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,798 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:21,798 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,798 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:21,798 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,799 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:21,799 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,799 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:21,799 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,799 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:21,800 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,800 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:21,800 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,800 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:21,801 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,801 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:21,801 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,801 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:21,802 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:21,804 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:21,805 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:21,806 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: None Exception iterating requests!
2024-12-18 03:12:29,426 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:29,522 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzdiMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:12:29,523 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:29,524 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:29,524 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,524 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:29,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,525 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:29,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,525 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:29,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,526 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:29,526 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,526 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:29,526 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,526 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:29,527 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:29,527 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:29,527 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:29,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:29,530 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:29,531 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:29,532 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:29,532 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:29,532 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:30,533 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.48 MB
2024-12-18 03:12:30,533 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:30,540 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:30,621 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FkYzg0OS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:12:30,622 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:30,623 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:30,623 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,623 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:30,624 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,624 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:30,624 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,624 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:30,624 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,625 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:30,625 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,625 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:30,625 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,626 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:30,626 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,626 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:30,626 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,627 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:30,627 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,627 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:30,627 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,628 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:30,628 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,628 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:30,628 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:30,630 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:30,631 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:30,632 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:30,632 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:30,632 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:31,633 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.57 MB
2024-12-18 03:12:31,633 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:31,639 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:31,717 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FkYzhkNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:12:31,717 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:31,718 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:31,718 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,718 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:31,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,719 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:31,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,719 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:31,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:31,720 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:31,720 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:31,721 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,721 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:31,721 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,721 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:31,721 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,722 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:31,722 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,722 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:31,722 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,722 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:31,723 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:31,724 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:31,725 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:31,726 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:31,726 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:31,727 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:32,727 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.57 MB
2024-12-18 03:12:32,728 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:32,734 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:32,818 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkYzk3OS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEw
2024-12-18 03:12:32,819 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:32,820 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:32,820 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,820 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:32,820 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,820 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,821 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,822 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:32,823 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:32,826 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:32,827 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:32,828 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:32,828 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:32,828 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:33,829 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.57 MB
2024-12-18 03:12:33,829 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:33,835 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:33,922 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkYzlmZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:12:33,922 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:33,923 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:33,923 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,924 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:33,924 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,924 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:33,924 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,924 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:33,925 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,925 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:33,925 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,925 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:33,926 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,926 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:33,926 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,926 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:33,927 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,927 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:33,927 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,927 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:33,928 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,928 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:33,928 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,928 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:33,929 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:33,930 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:33,932 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:33,933 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:33,933 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:33,933 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:34,933 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 176.57 MB
2024-12-18 03:12:34,934 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:34,940 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:35,022 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkY2E5ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:12:35,022 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:35,023 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:35,024 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,024 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:35,024 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,024 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:35,024 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,025 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:35,025 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,025 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:35,025 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,026 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:35,026 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,026 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:35,026 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,027 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:35,027 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,027 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:35,027 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,028 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:35,028 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,028 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:35,028 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,028 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:35,029 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:35,031 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:35,032 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:35,033 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:35,033 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:35,033 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:36,034 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.64 MB
2024-12-18 03:12:36,034 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:36,042 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:36,121 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FkY2IzMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:12:36,122 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:36,123 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:36,123 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,123 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:36,123 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:36,124 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,125 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:36,125 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,125 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:36,125 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,125 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:36,126 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,126 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:36,126 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,126 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:36,127 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,127 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:36,127 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,127 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:36,127 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:36,129 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:36,130 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:36,131 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:36,131 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:36,132 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:37,132 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.64 MB
2024-12-18 03:12:37,132 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:37,139 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:37,366 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkY2JjZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:12:37,367 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:37,367 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:37,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:37,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,368 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:37,368 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:37,369 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:37,369 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,369 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:37,370 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,370 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:37,370 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,370 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:37,370 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,371 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:37,371 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,371 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:37,371 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,372 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:37,372 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,372 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:37,372 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:37,374 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:37,375 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:37,376 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:37,376 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:37,376 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:38,377 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 176.67 MB
2024-12-18 03:12:38,377 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:38,384 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:38,463 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FkY2M2MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:12:38,464 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:38,465 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:38,465 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,465 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:38,465 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:38,466 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:38,467 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:38,467 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,467 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:38,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,468 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:38,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,468 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:38,468 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,469 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:38,469 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,469 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:38,469 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:38,471 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:38,473 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:38,473 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:38,474 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:38,474 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:39,475 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 176.67 MB
2024-12-18 03:12:39,475 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:39,482 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:12:39,559 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FkY2NmYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEw
2024-12-18 03:12:39,560 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-12...
2024-12-18 03:12:39,561 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:12:39,561 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,561 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:12:39,561 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,561 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:12:39,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:12:39,564 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,564 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:12:39,564 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,564 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:12:39,564 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:12:39,566 [ERROR] [consume_request_iterator] Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/venv/lib/python3.12/site-packages/grpc/_channel.py", line 276, in consume_request_iterator
    request = next(request_iterator)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'AppendRowsRequest' object is not an iterator
2024-12-18 03:12:39,567 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: None Exception iterating requests!
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 137, in _write_dataframe_to_bigquery
    response = write_client.append_rows(append_request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.Unknown: None Exception iterating requests!
2024-12-18 03:12:39,568 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: None Exception iterating requests!
2024-12-18 03:12:39,568 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:12:39,568 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:12:40,569 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.67 MB
2024-12-18 03:12:40,569 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:12:40,569 [INFO] [main] Processing completed: 10 successful, 10 failed.
2024-12-18 03:12:40,569 [WARNING] [main] Failed namespaces: ['default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default']
2024-12-18 03:12:41,570 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.67 MB
2024-12-18 03:12:41,571 [INFO] [<module>] Finished processing in 40.33 seconds
2024-12-18 03:16:36,262 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:16:36,262 [INFO] [main] Found 10 namespaces to process
2024-12-18 03:16:36,263 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:37,263 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:37,264 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:38,265 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:38,265 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:39,266 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:39,266 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:40,267 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:40,267 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:41,268 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:41,268 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:42,269 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:42,270 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:43,270 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 135.99 MB
2024-12-18 03:16:43,271 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:44,271 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:44,272 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:45,272 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:45,273 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:16:46,273 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.99 MB
2024-12-18 03:16:46,274 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,299 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,300 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,313 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,313 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,325 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,325 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,336 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,336 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,347 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,347 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,357 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,357 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,368 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,369 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,379 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,380 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,390 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,391 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,402 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,402 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,414 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,415 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,426 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,427 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,437 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,438 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,449 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,450 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,461 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,462 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,473 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,474 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,484 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,485 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,497 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,497 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,508 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,509 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,520 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,521 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,531 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,532 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,542 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,543 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,555 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,555 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,567 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,567 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,579 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,579 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,590 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,590 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,602 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,603 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,614 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,614 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,625 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,625 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,636 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,637 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,647 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,648 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,659 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,660 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,671 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,671 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,682 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,683 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,694 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,694 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,705 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,705 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,717 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,717 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,728 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,729 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,739 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,740 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,750 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,750 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,761 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,762 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,773 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,774 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,785 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,785 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,797 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,798 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,808 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,809 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,819 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,820 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,831 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,831 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,841 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,842 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,852 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,853 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,863 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,864 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,875 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,876 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,887 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,888 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,899 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,900 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:46,911 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,912 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:46,923 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,923 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:46,934 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,935 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:46,946 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,946 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:46,957 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,958 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:46,969 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,970 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:46,982 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,983 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:46,995 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:46,995 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:47,007 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,007 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:47,019 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,019 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:47,031 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,031 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:47,042 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,042 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:47,053 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,053 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:47,067 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,067 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:47,081 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,082 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:47,094 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,094 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:47,106 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,107 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:47,118 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,118 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:47,129 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,129 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:16:47,141 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,141 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:16:47,152 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,153 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:16:47,166 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,167 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:16:47,179 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,179 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:16:47,192 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,192 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:16:47,205 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,205 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:16:47,272 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,272 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:16:47,283 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:16:47,834 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,848 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,848 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,849 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,858 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,859 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,868 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,869 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,869 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,874 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,884 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,884 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,885 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,894 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,895 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,895 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,904 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,905 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,914 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,915 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,916 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,916 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,925 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,926 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,927 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,937 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,938 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,948 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,949 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,959 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,959 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,971 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,972 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,973 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,973 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,974 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,976 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,985 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:47,986 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:47,996 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:47,997 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,006 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,007 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,016 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,017 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,026 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,027 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,037 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,037 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,047 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,048 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,058 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,059 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,069 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,070 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,080 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,081 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,081 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,082 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,082 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,083 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,083 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,083 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:16:48,084 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,084 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,084 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,087 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,097 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,098 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,109 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,110 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,122 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,123 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,133 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,133 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,143 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,144 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,154 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,155 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,164 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,165 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,175 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,176 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,186 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,186 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,187 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,187 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,188 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,188 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,188 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,189 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,189 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,189 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,192 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,203 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,203 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,213 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,214 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,224 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,225 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,235 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,235 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,245 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,246 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,256 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,257 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,266 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,267 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,278 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,278 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,288 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,289 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,299 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,300 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,310 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,310 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,320 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,320 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,330 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,331 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,331 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,332 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,332 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,332 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,333 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,333 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,333 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,334 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,334 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,335 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,335 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,335 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,337 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,347 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,348 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,358 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,358 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,369 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,370 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,380 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,381 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,391 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,391 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,401 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,402 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,411 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,413 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,413 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,414 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,414 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,414 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,415 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,415 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,417 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,427 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,427 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,438 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,439 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,448 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,449 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,459 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,459 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,469 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,470 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,480 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,480 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,490 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,491 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,501 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,502 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,511 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,512 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,513 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,513 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,514 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,514 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,514 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,515 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,515 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:16:48,516 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,517 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,527 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,528 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,538 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,538 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,548 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,550 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:16:48,550 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,551 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:48,654 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,664 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,664 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,700 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,711 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,712 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,712 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,722 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,722 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:16:48,723 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,732 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,733 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,734 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,743 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,744 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,754 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,755 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:16:48,756 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:16:48,760 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,771 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,772 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,773 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,784 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,784 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,794 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,795 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,804 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,805 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,814 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,815 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,825 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,825 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,835 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,835 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,844 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,845 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,854 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,929 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:48,968 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:48,981 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:48,982 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:48,982 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,982 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,983 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,983 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,984 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,984 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,985 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,985 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,986 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:48,997 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,998 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:16:48,999 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:16:49,009 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:49,087 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,129 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,141 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,141 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,217 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,257 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,268 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,269 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,375 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,417 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,427 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,428 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,503 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,543 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,554 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,555 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,629 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,669 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,680 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,680 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,755 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,793 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,804 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,804 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,878 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:49,918 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:49,929 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:49,929 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:49,930 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:16:50,007 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:50,047 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:50,060 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:50,060 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:50,138 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:16:50,177 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:16:50,189 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:16:50,189 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:53,986 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,142 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,270 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,429 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,555 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,681 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,805 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:54,930 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:55,061 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:16:55,190 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:03,996 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:03,996 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:03,996 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:04,997 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:04,997 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:04,998 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:04,999 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:04,999 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:05,999 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:06,000 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:06,001 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:06,001 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:06,001 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:07,002 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:07,002 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:07,003 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:07,003 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:07,003 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:08,004 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:08,004 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:08,005 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:08,005 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:08,005 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:09,006 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:09,006 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:09,007 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:09,007 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:09,007 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:10,008 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:10,008 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:10,009 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:10,009 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:10,009 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:11,010 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:11,010 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:11,011 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:11,011 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:11,011 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:12,012 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:12,012 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:12,013 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:12,013 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:12,013 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:13,014 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:13,014 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:13,015 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: No module named 'google.cloud.bigquery_storage_v1.services.big_query_write.transports.big_query_write_grpc_transport'
2024-12-18 03:17:13,015 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:17:13,015 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:17:14,016 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:14,016 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:17:14,017 [INFO] [main] Processing completed: 10 successful, 10 failed.
2024-12-18 03:17:14,017 [WARNING] [main] Failed namespaces: ['default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default']
2024-12-18 03:17:15,018 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 167.57 MB
2024-12-18 03:17:15,019 [INFO] [<module>] Finished processing in 38.76 seconds
2024-12-18 03:18:27,594 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:18:27,594 [INFO] [main] Found 10 namespaces to process
2024-12-18 03:18:27,594 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:28,595 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:28,595 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:29,596 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:29,596 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:30,597 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:30,597 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:31,598 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:31,598 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:32,599 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:32,600 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:33,600 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:33,601 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:34,603 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:34,603 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:35,604 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:35,604 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:36,605 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:36,605 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:18:37,606 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.11 MB
2024-12-18 03:18:37,606 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:37,629 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,631 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:37,642 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,643 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:37,655 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,655 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:37,667 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,667 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:37,679 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,679 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:37,691 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,691 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:37,702 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,703 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:37,714 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,714 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:37,726 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,726 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:37,737 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,738 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:37,749 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,750 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:37,761 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,761 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:37,772 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,773 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:37,786 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,787 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:37,798 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,798 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:37,809 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,809 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:37,820 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,821 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:37,831 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,832 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:37,843 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,843 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:37,854 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,855 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:37,866 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,866 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:37,877 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,878 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:37,889 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,890 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:37,900 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,901 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:37,911 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,912 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:37,923 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,923 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:37,936 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,936 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:37,947 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,948 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:37,958 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,959 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:37,969 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,970 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:37,981 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,981 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:37,992 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:37,992 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,003 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,004 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,015 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,015 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,027 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,028 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,039 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,040 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,051 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,051 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,063 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,063 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,074 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,074 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,086 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,086 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,097 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,097 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,109 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,109 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,120 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,121 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,132 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,133 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,143 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,144 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,155 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,155 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,167 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,167 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,179 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,179 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,190 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,191 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,201 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,202 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,214 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,214 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,225 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,226 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,237 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,237 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,247 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,248 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,258 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,259 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,269 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,270 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,280 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,281 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,292 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,292 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,304 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,305 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,315 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,316 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,327 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,327 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,338 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,338 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,349 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,350 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,361 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,361 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,373 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,373 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,384 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,384 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,395 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,396 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,407 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,408 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,420 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,420 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,431 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,432 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,442 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,443 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,454 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,455 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:18:38,465 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,465 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:18:38,476 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,477 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:18:38,490 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,490 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:18:38,501 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,501 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:18:38,512 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,513 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:18:38,524 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,524 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:18:38,590 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:38,590 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:18:38,601 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:18:39,251 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,264 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,265 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,266 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,280 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,281 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,298 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,298 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,314 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,315 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,331 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,331 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,347 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,347 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,357 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,358 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,359 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,359 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,360 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,360 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,361 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,364 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,374 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,375 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,386 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,387 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,397 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,397 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,408 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,409 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,418 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,418 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,429 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,429 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,439 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,440 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,449 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,450 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,459 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,460 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,469 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,470 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,479 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,480 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,490 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,490 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,499 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,500 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,509 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,509 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,519 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,519 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,529 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,529 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,539 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,540 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,549 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,550 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,559 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,559 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,568 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,569 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,578 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,579 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,580 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,580 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,581 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,582 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,582 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,582 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,583 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,583 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,583 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,584 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,584 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,584 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,585 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,585 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,585 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,586 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,586 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,586 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,596 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,597 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,606 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,610 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,610 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,611 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,620 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,621 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,631 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,631 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,640 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,641 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,651 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,652 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,662 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,662 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,672 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,672 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,682 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,682 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,692 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,693 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,703 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,703 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,712 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,713 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,723 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,724 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,734 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,734 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,744 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,744 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,754 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,755 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,765 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,766 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,775 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,776 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,786 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,787 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,796 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,798 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,799 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,799 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,800 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,800 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,800 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:18:39,801 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:18:39,801 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,801 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,802 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,802 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:18:39,803 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,804 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,804 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,804 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,805 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,805 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,806 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,806 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,816 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,817 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,827 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,827 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,837 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,838 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,848 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,848 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,859 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,861 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,861 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,861 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,862 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,862 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,863 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,872 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,873 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,884 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,884 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,894 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,895 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,905 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,907 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,917 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,919 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,919 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:39,920 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,920 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:18:39,921 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:18:39,921 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,931 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,932 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,942 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,943 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,952 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,953 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,963 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,963 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,973 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,973 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,983 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,984 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:39,993 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:39,993 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,004 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,005 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,006 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,006 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,006 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,007 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,007 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,008 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,008 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,009 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,019 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,019 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,029 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,030 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,030 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:18:40,083 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,093 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,094 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,095 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,105 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,105 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,116 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,117 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,128 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,128 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,138 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,139 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,148 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,149 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,159 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,160 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,170 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,170 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,180 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,257 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:40,297 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:40,310 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:40,327 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:40,543 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODY4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:40,543 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODY4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:40,545 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:40,546 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:40,547 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,547 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:40,547 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,548 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:40,548 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,548 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:40,548 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,548 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:40,549 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,549 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:40,549 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,549 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:40,550 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,550 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:40,550 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,550 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:40,551 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,551 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:40,551 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,551 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:40,551 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,552 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:40,552 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:40,743 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODY4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODY4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:40,745 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODY4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:40,746 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,746 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,747 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,747 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,747 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,748 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,748 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,749 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,750 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:40,761 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:40,840 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:40,879 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:40,890 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:40,897 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:41,001 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODZkNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:18:41,001 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODZkNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:18:41,003 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:41,004 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:41,005 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,005 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:41,005 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,005 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:41,006 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,006 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:41,006 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,006 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:41,007 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,007 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:41,007 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,007 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:41,008 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,008 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:41,008 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,008 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:41,009 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,009 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:41,009 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,009 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:41,010 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,010 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:41,010 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,088 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODZkNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODZkNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:18:41,089 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODZkNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:18:41,169 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:41,214 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:41,226 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:41,234 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:41,317 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODcwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,317 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODcwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,319 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:41,320 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:41,320 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,320 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:41,320 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,320 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,321 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:41,322 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,323 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:41,323 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,323 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:41,324 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,324 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:41,324 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,394 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODcwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODcwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,395 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODcwYi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,473 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:41,512 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:41,523 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:41,530 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:41,622 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODczOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:41,623 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODczOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:41,624 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:41,625 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:41,626 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,626 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:41,627 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,627 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:41,627 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,627 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:41,627 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,628 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:41,628 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,628 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:41,629 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,629 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:41,629 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,629 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:41,630 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,631 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:41,631 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,700 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODczOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODczOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:41,701 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODczOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:41,776 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:41,817 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:41,828 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:41,835 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:41,976 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODc3MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,977 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODc3MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:41,978 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:41,979 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:41,980 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,980 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:41,980 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,980 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:41,981 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,981 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:41,981 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,981 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:41,982 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,982 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:41,982 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,982 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:41,982 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,983 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:41,983 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,983 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:41,983 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,983 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:41,984 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,984 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:41,984 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:41,984 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:41,985 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,053 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODc3MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODc3MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:42,055 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODc3MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czY
2024-12-18 03:18:42,133 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:42,173 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:42,184 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:42,192 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:42,271 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODdhMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:42,272 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODdhMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:42,273 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:42,274 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:42,275 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,275 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:42,275 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,275 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:42,276 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,276 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:42,276 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,276 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:42,276 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,277 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:42,277 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,277 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:42,277 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,277 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:42,278 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,278 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:42,278 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,278 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:42,279 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,279 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:42,279 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,279 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:42,279 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,352 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODdhMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODdhMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:42,353 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODdhMy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:42,433 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:42,473 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:42,484 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:42,491 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:42,573 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODdlNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
2024-12-18 03:18:42,573 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODdlNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
2024-12-18 03:18:42,575 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:42,576 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:42,576 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,576 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:42,577 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,577 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:42,577 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,577 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:42,577 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:42,578 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,579 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:42,579 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,579 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:42,580 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,580 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:42,580 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,580 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:42,580 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,581 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:42,581 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,656 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODdlNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODdlNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
2024-12-18 03:18:42,657 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODdlNi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEz
2024-12-18 03:18:42,734 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:42,775 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:42,786 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:42,793 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:42,873 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODgwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:42,873 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODgwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:42,875 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:42,876 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:42,876 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,876 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:42,877 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,877 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:42,877 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,877 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:42,877 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:42,878 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:42,878 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,878 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:42,879 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,879 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:42,879 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,879 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:42,879 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,880 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:42,880 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,880 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:42,880 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,881 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:42,881 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:42,951 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODgwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODgwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:42,952 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODgwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:42,953 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:18:44,332 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:18:44,342 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:44,343 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:18:44,419 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:18:44,459 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:18:44,470 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:18:44,477 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:44,556 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODhlMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:18:44,557 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODhlMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:18:44,558 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:44,559 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:44,560 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,560 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:44,560 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,560 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:44,561 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,561 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:44,561 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,561 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:44,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,562 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:44,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,562 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:44,562 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:44,563 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,563 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:44,563 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,564 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:44,564 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,564 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:44,564 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,564 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:44,565 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:44,611 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODhlMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODhlMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:18:44,612 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODhlMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:18:45,754 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:45,852 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODk5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:45,853 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODk5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:45,854 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:45,856 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:45,857 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,857 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:45,857 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,858 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:45,858 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,858 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:45,858 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,859 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:45,859 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,859 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:45,859 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,860 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:45,860 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,860 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:45,860 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,861 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:45,861 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,861 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:45,861 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,861 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:45,862 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,862 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:45,862 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:45,936 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODk5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODk5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:45,937 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODk5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:46,097 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:46,171 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODljNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:46,172 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODljNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:46,173 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:46,174 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:46,175 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,175 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:46,175 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,175 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:46,175 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,176 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:46,176 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,176 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:46,176 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,177 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:46,177 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,177 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:46,177 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,178 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:46,178 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,178 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:46,178 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:46,179 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,253 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODljNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODljNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:46,254 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlODljNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czM
2024-12-18 03:18:46,404 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:46,483 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODllOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:46,484 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODllOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:46,485 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:46,487 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:46,487 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,487 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:46,488 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,488 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:46,488 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,488 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:46,488 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,489 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:46,489 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,489 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:46,489 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,489 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:46,490 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,490 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:46,490 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,491 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:46,491 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,491 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:46,491 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,491 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:46,492 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,492 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:46,492 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,565 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODllOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODllOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:46,566 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlODllOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:46,708 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:46,789 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:18:46,789 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:18:46,790 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:46,791 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,792 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:46,793 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,793 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:46,793 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,793 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,794 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:46,795 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,795 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:46,795 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,795 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:46,796 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,796 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:46,796 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:46,871 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:18:46,872 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEwNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE
2024-12-18 03:18:47,062 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:47,144 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEzNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:47,144 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEzNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:47,146 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:47,147 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:47,148 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,148 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:47,148 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,149 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:47,149 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,149 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:47,149 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,150 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:47,150 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,150 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:47,150 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:47,151 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,152 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:47,152 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,152 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:47,152 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,152 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:47,153 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,215 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEzNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEzNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:47,216 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGEzNy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:47,360 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:47,440 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGE2ZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:47,440 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGE2ZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:47,442 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:47,443 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:47,443 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,443 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:47,444 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:47,445 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,446 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:47,446 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,446 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:47,446 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,447 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:47,447 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,447 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:47,447 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,522 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGE2ZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGE2ZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:47,523 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGE2ZC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:47,666 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:47,742 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGE5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:47,742 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGE5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:47,744 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:47,745 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:47,746 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,746 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:47,746 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,746 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:47,747 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,747 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:47,747 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,747 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:47,747 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,748 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:47,748 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,748 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:47,748 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,748 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:47,749 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,749 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:47,749 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,749 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:47,750 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,750 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:47,750 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,750 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:47,750 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:47,828 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGE5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGE5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:47,829 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGE5MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEy
2024-12-18 03:18:47,960 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:48,038 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGFiOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:48,038 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGFiOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:48,040 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:48,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:48,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:48,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:48,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:48,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,043 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:48,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,043 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,044 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,045 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:48,046 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:48,115 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGFiOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGFiOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:48,116 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGFiOS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:49,621 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:49,695 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGI4MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:49,695 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGI4MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:49,697 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:49,698 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:49,699 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:49,699 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:49,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,701 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:49,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,701 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:49,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,702 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:49,702 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,702 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:49,703 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,703 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:49,703 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,703 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:49,704 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:49,777 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGI4MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGI4MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:49,778 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGI4MC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czk
2024-12-18 03:18:55,950 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:56,034 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGViYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ
2024-12-18 03:18:56,034 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGViYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ
2024-12-18 03:18:56,036 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:56,037 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:56,037 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,038 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:56,038 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,038 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:56,038 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,038 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:56,039 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,039 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:56,039 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,039 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:56,040 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,040 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:56,040 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,040 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:56,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:56,041 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,041 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:56,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,042 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:56,042 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,043 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:56,043 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:56,091 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGViYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGViYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ
2024-12-18 03:18:56,092 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGViYy0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ
2024-12-18 03:18:56,093 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:18:56,093 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:18:57,093 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.27 MB
2024-12-18 03:18:57,093 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:18:57,100 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:57,181 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGY1MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:57,181 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGY1MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:57,183 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:57,184 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:57,185 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,185 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:57,185 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:57,186 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,187 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:57,187 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,187 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:57,187 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,187 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:57,188 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,188 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:57,188 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,188 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:57,189 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,189 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:57,189 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,189 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:57,189 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:57,261 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGY1MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGY1MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:57,262 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOGY1MS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:18:57,262 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:18:57,262 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:18:58,263 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.49 MB
2024-12-18 03:18:58,263 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:18:58,270 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:58,350 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGZmNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:58,351 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGZmNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:58,352 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:58,353 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:58,354 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,354 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:58,354 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,354 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:58,355 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,355 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:58,355 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,355 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:58,356 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,356 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:58,356 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,357 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:58,357 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,357 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:58,357 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,358 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:58,358 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,358 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:58,358 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,359 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:58,359 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,359 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:58,359 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:58,431 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGZmNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGZmNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:58,432 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FlOGZmNC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czE0
2024-12-18 03:18:58,433 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:18:58,433 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:18:59,433 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.50 MB
2024-12-18 03:18:59,433 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:18:59,440 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:18:59,518 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTA4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:18:59,519 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTA4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:18:59,520 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:18:59,522 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:18:59,522 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,522 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:18:59,523 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,523 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:18:59,523 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,524 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:18:59,524 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,524 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:18:59,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,525 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:18:59,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,525 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:18:59,525 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,526 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:18:59,526 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,526 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:18:59,526 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:18:59,527 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:18:59,527 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,527 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:18:59,528 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:18:59,595 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTA4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTA4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:18:59,596 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTA4Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:18:59,596 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:18:59,596 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:00,597 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.67 MB
2024-12-18 03:19:00,597 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:00,604 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:00,695 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTEyMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:19:00,695 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTEyMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:19:00,697 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:00,698 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:00,698 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,698 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:00,698 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,699 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,700 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,701 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:00,702 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:00,751 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTEyMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTEyMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:19:00,752 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTEyMS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czc
2024-12-18 03:19:00,752 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:00,752 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:01,753 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 176.79 MB
2024-12-18 03:19:01,753 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:01,760 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:01,838 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTFjNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:01,838 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTFjNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:01,839 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:01,840 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:01,840 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:01,841 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,842 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:01,843 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,843 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:01,843 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,844 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:01,845 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,845 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:01,845 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,845 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:01,845 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:01,923 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTFjNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTFjNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:01,924 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTFjNS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:01,924 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:01,924 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:02,925 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 177.04 MB
2024-12-18 03:19:02,925 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:02,932 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:03,011 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTI1ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:19:03,011 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTI1ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:19:03,013 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:03,014 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:03,014 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,014 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:03,014 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,015 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:03,015 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,015 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:03,015 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,015 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:03,016 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,016 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:03,016 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,016 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:03,016 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,017 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:03,017 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,017 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:03,017 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,017 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:03,018 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,018 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:03,018 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,018 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:03,018 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:03,065 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTI1ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTI1ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:19:03,066 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTI1ZS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czg
2024-12-18 03:19:03,067 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:03,067 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:04,067 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 177.07 MB
2024-12-18 03:19:04,068 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:04,074 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:04,152 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTJmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:04,152 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTJmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:04,154 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:04,155 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:04,156 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,156 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:04,157 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,157 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:04,157 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,157 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:04,157 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,158 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:04,158 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,158 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:04,159 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,159 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:04,159 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:04,160 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,161 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:04,161 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,161 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:04,161 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:04,229 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTJmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTJmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:04,230 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTJmMi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:04,230 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:04,230 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:05,231 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 177.26 MB
2024-12-18 03:19:05,232 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:05,238 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:05,371 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTM5My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
2024-12-18 03:19:05,371 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTM5My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
2024-12-18 03:19:05,373 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:05,374 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:05,374 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,374 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:05,375 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,376 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:05,377 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,377 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:05,377 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,377 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:05,378 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,378 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:05,378 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:05,465 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTM5My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTM5My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
2024-12-18 03:19:05,466 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTM5My0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czU
2024-12-18 03:19:05,466 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:05,466 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:06,467 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 177.42 MB
2024-12-18 03:19:06,467 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:06,468 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:19:06,479 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:19:06,480 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:19:06,554 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:19:06,610 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:19:06,622 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:19:06,629 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:06,715 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTQ0Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:19:06,715 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTQ0Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:19:06,717 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:06,718 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:06,718 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,718 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:06,719 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:06,720 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,721 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:06,721 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,721 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:06,721 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,722 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:06,722 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,722 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:06,722 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:06,788 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTQ0Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTQ0Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:19:06,789 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/CiQ2Y2FlOTQ0Zi0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM
2024-12-18 03:19:11,801 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:11,891 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTZlMC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI
2024-12-18 03:19:11,891 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTZlMC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI
2024-12-18 03:19:11,893 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:11,893 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:11,894 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,894 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:11,894 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,895 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:11,895 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,895 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:11,895 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,895 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:11,896 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,896 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:11,896 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,896 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:11,897 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,897 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:11,897 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,897 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:11,898 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,898 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:11,898 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,898 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:11,899 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,899 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:11,899 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:11,975 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTZlMC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTZlMC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI
2024-12-18 03:19:11,976 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOTZlMC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czI
2024-12-18 03:19:21,993 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:19:22,078 [INFO] [_write_dataframe_to_bigquery] Created write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOWJmOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:22,079 [INFO] [_write_dataframe_to_bigquery] Starting streaming append to write stream: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOWJmOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:22,080 [INFO] [request_generator] Processing batch 0-12...
2024-12-18 03:19:22,082 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:19:22,083 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,083 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:19:22,083 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,084 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:19:22,084 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,084 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:19:22,084 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,085 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:19:22,085 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,085 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:19:22,086 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,086 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:19:22,086 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,086 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:19:22,087 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,087 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:19:22,087 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,087 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:19:22,088 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,088 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:19:22,088 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,088 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:19:22,088 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:19:22,163 [ERROR] [_write_dataframe_to_bigquery] Failed to write DataFrame to BigQuery: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOWJmOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
Traceback (most recent call last):
  File "/home/admin_/kubernetes-engine-samples/cost-optimization/gke-vpa-recommendations/metrics-exporter/services/bigquery_service.py", line 143, in _write_dataframe_to_bigquery
    response_iter = write_client.append_rows(request_generator())
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/cloud/bigquery_storage_v1/services/big_query_write/client.py", line 945, in append_rows
    response = rpc(
               ^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 120, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 174, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOWJmOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:22,164 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: 400 Expect a user schema to be passed in Entity: projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FlOWJmOC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czA
2024-12-18 03:19:22,164 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:19:22,164 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:19:23,165 [INFO] [log_resource_usage] Resource Usage: CPU = 1.00%, Memory = 177.42 MB
2024-12-18 03:19:23,165 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:19:23,165 [INFO] [main] Processing completed: 10 successful, 10 failed.
2024-12-18 03:19:23,165 [WARNING] [main] Failed namespaces: ['default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default', 'default']
2024-12-18 03:19:24,166 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 177.42 MB
2024-12-18 03:19:24,167 [INFO] [<module>] Finished processing in 56.57 seconds
2024-12-18 03:22:40,431 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:22:40,431 [INFO] [main] Found 1 namespaces to process
2024-12-18 03:22:40,431 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:22:41,432 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.85 MB
2024-12-18 03:22:41,432 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:22:41,456 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,458 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:22:41,469 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,469 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:22:41,481 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,482 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:22:41,493 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,493 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:22:41,504 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,505 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:22:41,516 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,517 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:22:41,529 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:41,529 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:22:41,541 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:22:42,058 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,072 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:22:42,073 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:22:42,073 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,084 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:22:42,085 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,094 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:22:42,095 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:22:42,095 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:22:42,096 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,106 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:22:42,107 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,116 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:22:42,117 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:22:42,118 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:22:42,534 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,544 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:22:42,545 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:22:42,748 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,758 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:22:42,758 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:22:42,762 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:22:42,772 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:22:42,772 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:22:42,846 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:22:42,887 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:22:42,900 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:22:42,917 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:22:43,060 [INFO] [_write_dataframe_to_bigquery] Processing batch 0-500...
2024-12-18 03:22:43,061 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:22:43,062 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,062 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:22:43,062 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,062 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:22:43,063 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,063 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:22:43,063 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,063 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:22:43,064 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,064 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:22:43,064 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,064 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:22:43,065 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,065 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:22:43,065 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,065 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:22:43,066 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,066 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:22:43,066 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,066 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:22:43,067 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,067 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:22:43,067 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:22:43,229 [DEBUG] [_write_dataframe_to_bigquery] Batch response: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cig2Y2FmMDU0OC0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czEw"

2024-12-18 03:22:43,230 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 03:22:43,230 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 03:22:43,231 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 03:22:43,231 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:22:44,232 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 144.78 MB
2024-12-18 03:22:44,232 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:22:44,233 [INFO] [main] Processing completed: 1 successful, 0 failed.
2024-12-18 03:22:45,234 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 144.78 MB
2024-12-18 03:22:45,235 [INFO] [<module>] Finished processing in 4.81 seconds
2024-12-18 03:28:27,461 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:28:27,461 [INFO] [main] Found 1 namespaces to process
2024-12-18 03:28:27,461 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:28:28,462 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 136.29 MB
2024-12-18 03:28:28,462 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:28:28,486 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,487 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:28:28,498 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,499 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:28:28,511 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,512 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:28:28,523 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,524 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:28:28,534 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,535 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:28:28,545 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,546 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:28:28,557 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:28,557 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:28:28,568 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:28:29,154 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,168 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:28:29,169 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:28:29,170 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,180 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:28:29,181 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,191 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:28:29,191 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,201 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:28:29,202 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,212 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:28:29,212 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:28:29,213 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:28:29,213 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:28:29,214 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:28:29,215 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,224 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:28:29,225 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:29,236 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:28:29,237 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:28:29,238 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:28:29,993 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:28:30,003 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:28:30,004 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:28:30,086 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:28:30,129 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:28:30,141 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:28:30,142 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 1: _write_dataframe_to_bigquery() got an unexpected keyword argument 'batch_size'
2024-12-18 03:28:35,147 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 2: _write_dataframe_to_bigquery() got an unexpected keyword argument 'batch_size'
2024-12-18 03:28:45,155 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write error on attempt 3: _write_dataframe_to_bigquery() got an unexpected keyword argument 'batch_size'
2024-12-18 03:28:45,155 [ERROR] [write_to_bigquery_with_retries] [Namespace: default] BigQuery write failed after 3 retries
2024-12-18 03:28:45,155 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:28:46,156 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 142.47 MB
2024-12-18 03:28:46,156 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:28:46,157 [INFO] [main] Processing completed: 1 successful, 1 failed.
2024-12-18 03:28:46,157 [WARNING] [main] Failed namespaces: ['default']
2024-12-18 03:28:47,158 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 143.28 MB
2024-12-18 03:28:47,159 [INFO] [<module>] Finished processing in 19.70 seconds
2024-12-18 03:29:34,791 [INFO] [main] Processing metrics for date range: 2024-12-04 00:00:00 to 2024-12-17 00:00:00
2024-12-18 03:29:34,791 [INFO] [main] Found 1 namespaces to process
2024-12-18 03:29:34,791 [INFO] [process_namespace] [Namespace: default] Starting processing
2024-12-18 03:29:35,792 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 135.97 MB
2024-12-18 03:29:35,792 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time'.
2024-12-18 03:29:35,815 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,817 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores'.
2024-12-18 03:29:35,828 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,828 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores'.
2024-12-18 03:29:35,839 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,840 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes'.
2024-12-18 03:29:35,851 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,852 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes'.
2024-12-18 03:29:35,862 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,863 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes'.
2024-12-18 03:29:35,874 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,875 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes'.
2024-12-18 03:29:35,885 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:35,886 [INFO] [_fetch_timeseries_data] Starting async data fetch for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores'.
2024-12-18 03:29:35,896 [INFO] [_fetch_timeseries_data] Fetching data from URL: https://monitoring.googleapis.com/v3/projects/gke-rightsize/timeSeries
2024-12-18 03:29:36,395 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:36,409 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:29:36,410 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/memory/per_replica_recommended_request_bytes' contains 12 rows.
2024-12-18 03:29:36,410 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:36,420 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:29:36,421 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:36,430 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:29:36,431 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/limit_bytes' contains 12 rows.
2024-12-18 03:29:36,431 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/autoscaler/container/cpu/per_replica_recommended_request_cores' contains 12 rows.
2024-12-18 03:29:36,602 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:36,612 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:29:36,613 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/request_cores' contains 12 rows.
2024-12-18 03:29:36,658 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:36,668 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:29:36,668 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/limit_cores' contains 12 rows.
2024-12-18 03:29:37,281 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:37,291 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:29:37,292 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/cpu/core_usage_time' contains 12 rows.
2024-12-18 03:29:37,542 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:37,552 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:29:37,553 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/used_bytes' contains 12 rows.
2024-12-18 03:29:41,024 [INFO] [_fetch_timeseries_data] Async API call successful.
2024-12-18 03:29:41,034 [INFO] [_fetch_timeseries_data] Processed data for metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:29:41,035 [INFO] [_fetch_timeseries_data] Final DataFrame for namespace 'default' and metric 'kubernetes.io/container/memory/request_bytes' contains 12 rows.
2024-12-18 03:29:41,110 [INFO] [process_namespace] [Namespace: default] Merging dataframes
2024-12-18 03:29:41,151 [INFO] [process_namespace] [Namespace: default] Building VPA recommendations
2024-12-18 03:29:41,165 [INFO] [process_namespace] [Namespace: default] Writing recommendations to BigQuery
2024-12-18 03:29:41,183 [INFO] [_write_dataframe_to_bigquery] Writing DataFrame to BigQuery table: gke-vpa-recommendations
2024-12-18 03:29:41,433 [INFO] [_write_dataframe_to_bigquery] Serializing all rows...
2024-12-18 03:29:41,434 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'adservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.1593721652682376, 'cpu_requested_mcores': 200.00000000002, 'cpu_limit_mcores': 299.9999999999715, 'memory_mib_usage_max': 83.2578125, 'memory_requested_mib': 88.0, 'memory_limit_mib': 154.0, 'cpu_request_utilization': 0.005796860826340608, 'memory_request_utilization': 0.9461115056818182, 'cpu_requested_recommendation': 6.44786230912895, 'cpu_limit_recommendation': 16.119655772822373, 'memory_requested_recommendation': 104.0, 'memory_limit_recommendation': 104.0, 'priority': -0.9026350494842637}
2024-12-18 03:29:41,435 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,435 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'cartservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.365090985857867, 'cpu_requested_mcores': 200.00000000001995, 'cpu_limit_mcores': 299.9999999999716, 'memory_mib_usage_max': 41.15625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.016825454929287654, 'memory_request_utilization': 0.64306640625, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 58.0, 'memory_limit_recommendation': 58.0, 'priority': -0.5168754942803426}
2024-12-18 03:29:41,435 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,435 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'checkoutservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.224721568950366, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 25.000000000002494, 'memory_mib_usage_max': 13.64453125, 'memory_requested_mib': 20.0, 'memory_limit_mib': 40.0, 'cpu_request_utilization': 0.22247215689504538, 'memory_request_utilization': 0.6822265625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 28.0, 'memory_limit_recommendation': 28.0, 'priority': 0.9863146142128404}
2024-12-18 03:29:41,436 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,436 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'currencyservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.9027570446529625, 'cpu_requested_mcores': 0.0, 'cpu_limit_mcores': 0.0, 'memory_mib_usage_max': 33.26953125, 'memory_requested_mib': 0.0, 'memory_limit_mib': 0.0, 'cpu_request_utilization': 1.0, 'memory_request_utilization': 1.0, 'cpu_requested_recommendation': 19.825780497676565, 'cpu_limit_recommendation': 49.56445124419141, 'memory_requested_recommendation': 42.0, 'memory_limit_recommendation': 42.0, 'priority': 6.5}
2024-12-18 03:29:41,436 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,436 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'emailservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 7.6990847979182035, 'cpu_requested_mcores': 15.000000000000497, 'cpu_limit_mcores': 30.000000000000995, 'memory_mib_usage_max': 39.81640625, 'memory_requested_mib': 138.0, 'memory_limit_mib': 500.0, 'cpu_request_utilization': 0.5132723198611966, 'memory_request_utilization': 0.28852468297101447, 'cpu_requested_recommendation': 35.807564892943425, 'cpu_limit_recommendation': 89.51891223235856, 'memory_requested_recommendation': 59.0, 'memory_limit_recommendation': 59.0, 'priority': 3.5610177159879597}
2024-12-18 03:29:41,437 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,437 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'frontend', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 3.570025026896611, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 200.00000000001995, 'memory_mib_usage_max': 14.71875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.03570025026896255, 'memory_request_utilization': 0.22998046875, 'cpu_requested_recommendation': 20.420553912606863, 'cpu_limit_recommendation': 51.05138478151716, 'memory_requested_recommendation': 18.0, 'memory_limit_recommendation': 18.0, 'priority': 0.03777140826721914}
2024-12-18 03:29:41,437 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,437 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'loadgenerator', 'controller_type': 'Deployment', 'container_name': 'main', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.1599238533498704, 'cpu_requested_mcores': 299.9999999999715, 'cpu_limit_mcores': 500.0, 'memory_mib_usage_max': 129.9140625, 'memory_requested_mib': 256.0, 'memory_limit_mib': 512.0, 'cpu_request_utilization': 0.007199746177833585, 'memory_request_utilization': 0.507476806640625, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 690.0, 'memory_limit_recommendation': 690.0, 'priority': -0.45347871030687315}
2024-12-18 03:29:41,437 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,438 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'paymentservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 0.9165558300170045, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 100.00000000001, 'memory_mib_usage_max': 32.66796875, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.009165558300169128, 'memory_request_utilization': 0.51043701171875, 'cpu_requested_recommendation': 5.900707412856961, 'cpu_limit_recommendation': 14.751768532142401, 'memory_requested_recommendation': 41.0, 'memory_limit_recommendation': 41.0, 'priority': -0.44169532446748155}
2024-12-18 03:29:41,438 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,438 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'productcatalogservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 2.4310133258744266, 'cpu_requested_mcores': 100.00000000000998, 'cpu_limit_mcores': 100.00000000000998, 'memory_mib_usage_max': 12.0703125, 'memory_requested_mib': 64.0, 'memory_limit_mib': 64.0, 'cpu_request_utilization': 0.02431013325874184, 'memory_request_utilization': 0.1885986328125, 'cpu_requested_recommendation': 15.194809905191278, 'cpu_limit_recommendation': 37.987024762978194, 'memory_requested_recommendation': 15.0, 'memory_limit_recommendation': 15.0, 'priority': -0.006272633371936176}
2024-12-18 03:29:41,438 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,439 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'recommendationservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 5.242702109863503, 'cpu_requested_mcores': 9.999999999999606, 'cpu_limit_mcores': 19.99999999999921, 'memory_mib_usage_max': 39.6796875, 'memory_requested_mib': 22.0, 'memory_limit_mib': 45.0, 'cpu_request_utilization': 0.5242702109863709, 'memory_request_utilization': 1.8036221590909092, 'cpu_requested_recommendation': 25.114705574614764, 'cpu_limit_recommendation': 62.78676393653691, 'memory_requested_recommendation': 164.0, 'memory_limit_recommendation': 164.0, 'priority': 2.128404423306873}
2024-12-18 03:29:41,439 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,439 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'redis-cart', 'controller_type': 'Deployment', 'container_name': 'redis', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.8631692895004905, 'cpu_requested_mcores': 50.00000000000499, 'cpu_limit_mcores': 50.00000000000499, 'memory_mib_usage_max': 3.46484375, 'memory_requested_mib': 50.0, 'memory_limit_mib': 50.0, 'cpu_request_utilization': 0.03726338579000609, 'memory_request_utilization': 0.069296875, 'cpu_requested_recommendation': 9.193109884125745, 'cpu_limit_recommendation': 22.982774710314363, 'memory_requested_recommendation': 5.0, 'memory_limit_recommendation': 5.0, 'priority': 0.2101785184250457}
2024-12-18 03:29:41,439 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,440 [DEBUG] [serialize_row] Serializing row: {'start_datetime': Timestamp('2024-12-04 00:00:00'), 'end_datetime': Timestamp('2024-12-17 00:00:00'), 'project_id': 'gke-rightsize', 'location': 'us-central1-f', 'cluster_name': 'online-boutique', 'namespace_name': 'default', 'controller_name': 'shippingservice', 'controller_type': 'Deployment', 'container_name': 'server', 'run_date': datetime.date(2024, 12, 18), 'cpu_mcore_usage': 1.3459931366405529, 'cpu_requested_mcores': 100.00000000001, 'cpu_limit_mcores': 200.00000000002, 'memory_mib_usage_max': 10.3515625, 'memory_requested_mib': 64.0, 'memory_limit_mib': 128.0, 'cpu_request_utilization': 0.013459931366404183, 'memory_request_utilization': 0.1617431640625, 'cpu_requested_recommendation': 7.93005734185575, 'cpu_limit_recommendation': 19.825143354639373, 'memory_requested_recommendation': 14.0, 'memory_limit_recommendation': 14.0, 'priority': -0.060793678814468635}
2024-12-18 03:29:41,440 [DEBUG] [serialize_row] Row serialized successfully.
2024-12-18 03:29:41,762 [DEBUG] [_write_dataframe_to_bigquery] Response from server: append_result {
  offset {
  }
}
write_stream: "projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FmZGY1YS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ"

2024-12-18 03:29:41,763 [INFO] [_thread_main] Thread-ConsumeBidirectionalStream exiting
2024-12-18 03:29:41,764 [INFO] [_on_rpc_done] RPC termination has signaled streaming pull manager shutdown.
2024-12-18 03:29:41,764 [INFO] [_write_dataframe_to_bigquery] Finalizing write stream...
2024-12-18 03:29:41,883 [INFO] [_write_dataframe_to_bigquery] Committing write stream...
2024-12-18 03:29:42,180 [INFO] [_write_dataframe_to_bigquery] Writes to stream: 'projects/gke-rightsize/datasets/gke_metrics_dataset/tables/gke-vpa-recommendations/streams/Cic2Y2FmZGY1YS0wMDAwLTI5NzUtOGUwZS1kNGY1NDdmZmZhMmM6czQ' have been committed.
2024-12-18 03:29:42,181 [INFO] [_write_dataframe_to_bigquery] DataFrame successfully written to BigQuery.
2024-12-18 03:29:42,181 [INFO] [process_namespace] [Namespace: default] Successfully processed
2024-12-18 03:29:43,182 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 146.13 MB
2024-12-18 03:29:43,182 [INFO] [process_namespace] [Namespace: default] Finished processing
2024-12-18 03:29:43,183 [INFO] [main] Processing completed: 1 successful, 0 failed.
2024-12-18 03:29:44,183 [INFO] [log_resource_usage] Resource Usage: CPU = 0.00%, Memory = 146.13 MB
2024-12-18 03:29:44,185 [INFO] [<module>] Finished processing in 9.39 seconds
